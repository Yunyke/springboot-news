<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head translate="no">
<meta charset="UTF-8">
<title th:text="${title}">Daily News</title>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
	rel="stylesheet">
<link
	href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&display=swap"
	rel="stylesheet">

<style>
body {
	margin: 0;
	padding: 0;
	background-color: #f8f9fa;
	font-family: Arial, sans-serif;
}

.header-title {
	font-family: 'Playfair Display', serif;
	font-weight: 700;
	font-size: 6rem;
	text-align: center;
	margin-top: 20px;
	color: #000;
	letter-spacing: 0.05em;
	font-style: normal;
}

.nav-link:hover {
	color: #ffcc00 !important;
	background-color: #333333;
	border-radius: 5px;
	transition: background-color 0.3s ease, color 0.3s ease;
}

.grid-container {
	padding: 20px;
	background-color: #f8f9fa;
	display: block;
}

.news-section {
	margin-bottom: 30px; /* é¡¯ç¤ºå€å¡Šé–“çš„é–“è· */
	background-color: #f0f0f0; /* è¨­ç½®èƒŒæ™¯è‰² */
	padding: 20px; /* å‘å³åç§»ï¼Œé€™è£¡çš„40pxæœƒè®“å€å¡Šæ›´é å³ */
	border-radius: 8px; /* åœ“è§’æ•ˆæœ */
}

h2.news-section-title {
	margin-bottom: 20px; /* æ¸›å°‘æ¨™é¡Œèˆ‡å¡ç‰‡ä¹‹é–“çš„ç©ºé–“ */
	text-align: left; /* ç¢ºä¿æ¨™é¡Œå·¦å°é½Š */
	margin-left: 15px; /* å¢åŠ å·¦è¾¹è·ï¼Œå‘å³åç§» */
}

/* æ–°èå€å¡Šçš„æ’åˆ— */
.news-grid {
	display: grid;
	grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
	gap: 20px;
	align-items: start;
}

/* å¡ç‰‡æ¨£å¼èª¿æ•´ */
.news-card {
	background-color: #f7f7f7;
	box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
	border-radius: 8px;
	cursor: pointer;
	display: flex;
	flex-direction: row;
	padding: 10px;
	position: relative; /* è®“ tooltip å¯ä»¥å®šä½ */
	transition: background-color 0.3s ease;
	margin: 10px;
	height: 135px;
}

.hover-description {
	display: none;
	position: absolute;
	background-color: rgba(50, 50, 50, 0.9);
	color: #fff;
	padding: 10px;
	border-radius: 6px;
	font-size: 0.9rem;
	max-width: 500px;
	z-index: 999;
	box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
	top: 100%; /* å‡ºç¾åœ¨å¡ç‰‡ä¸‹æ–¹ */
	left: 0;
	white-space: normal;
}

.news-card:hover .hover-description {
	display: block;
}

.news-img {
	width: auto;
	height: auto;
	object-fit: contain;
	max-width: 45%;
	max-height: 100px;
	flex-shrink: 0;
	border-radius: 6px;
	margin-right: 15px;
	margin-top: 5px;
}

/* æ–‡å­—å…§å®¹å€ */
.news-content {
	padding-top: 5px; /* âœ… è¼•å¾®ä¸Šé‚Šè·æ§åˆ¶é–“è· */
	padding-bottom: 20px; /* âœ… ä¿ç•™åº•éƒ¨ç©ºé–“çµ¦æ™‚é–“ */
	display: flex;
	flex-direction: column;
	justify-content: flex-start;
	flex-grow: 1;
	max-height: 120px;
	overflow: hidden; /* é˜²æ­¢æ–‡å­—æº¢å‡º */
}

/* æ¨™é¡ŒåŠ å¤§ä¸¦æ›è¡Œ */
.news-title {
	font-weight: 700;
	font-size: 1.2rem;
	margin: 0 0 8px 0;
	word-wrap: break-word;
	line-height: 1.2;
	overflow: visible;
	text-overflow: normal; /* è¶…éç¯„åœé¡¯ç¤ºçœç•¥è™Ÿ */
	white-space: normal; /* å…è¨±æ¨™é¡Œæ›è¡Œ */
}

.news-time {
	position: absolute;
	bottom: 10px;
	right: 15px;
	font-size: 0.8rem;
	color: #888;
}

/* æ‘˜è¦é™åˆ¶æœ€å¤šä¸‰è¡Œï¼Œå¤šçš„é¡¯ç¤º... */
.news-desc {
	flex-grow: 1;
	overflow: hidden;
	display: -webkit-box;
	-webkit-line-clamp: 3; /* é™åˆ¶æœ€å¤šé¡¯ç¤ºä¸‰è¡Œ */
	-webkit-box-orient: vertical;
	text-overflow: ellipsis;
	margin: 0 0 8px 0;
	color: #444;
	font-size: 0.9rem;
}

/* æ¨™ç±¤èˆ‡åˆ†é¡ */
.news-tags {
	font-size: 0.8rem;
	color: #666;
	margin-top: auto;
}

.star-button {
	background: none;
	border: none;
	cursor: pointer;
	padding: 0;
}

.news-item {
	position: relative;
	padding: 1rem;
	border-bottom: 1px solid #ccc;
}

.star-form {
	position: absolute;
	top: 0.5rem;
	right: 0.5rem;
}

.star-button {
	background: none;
	border: none;
	cursor: pointer;
	font-size: 1.5rem;
	padding: 0;
}

.star {
    color: gray;
    transition: color 0.3s, transform 0.2s;
}

.star.filled {
    color: hotpink; /* å¯ä»¥æ›æˆ crimsonã€deeppinkã€red çœ‹ä½ å–œæ­¡å“ªç¨® */
}

.star:hover {
    color: pink;
    transform: scale(1.2);
}

/* éš±è— Google ç¿»è­¯ */
#google_translate_element {
	display: none !important;
}

.goog-te-banner-frame.skiptranslate {
	display: none !important;
}

body {
	top: 0 !important;
}
</style>
</head>
<body>
	<div id="google_translate_element" style="display: none;"></div>
	<!-- Google Translate -->
	<script type="text/javascript">
    function googleTranslateElementInit() {
      new google.translate.TranslateElement({
        pageLanguage: 'en',
        includedLanguages: 'zh-TW',
        layout: google.translate.TranslateElement.InlineLayout.SIMPLE
      }, 'google_translate_element');

      // å¼·åˆ¶åˆ‡æ›æˆç¹é«”ä¸­æ–‡
      setTimeout(() => {
        const elem = document.getElementById('google_translate_element');
        if (elem) elem.style.display = 'none';
        const select = document.querySelector('select.goog-te-combo');
        if (select) {
          select.value = 'zh-TW';
          select.dispatchEvent(new Event('change'));
        }
      }, 1000); // ç­‰å¾…å…ƒä»¶è¼‰å…¥1ç§’å†åˆ‡æ›
    }
  </script>
	<script
		src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>


	<!-- ğŸ”µ é é¢ä¸»æ¨™é¡Œ -->
	<div class="header-title notranslate" translate="no">Daily News</div>

	<!-- ğŸ”µ å°è¦½åˆ— -->
	<nav class="navbar navbar-expand-lg navbar-dark bg-dark mt-3 mb-4">
		<div class="container-fluid">
			<a class="navbar-brand" href="#" translate="no">Home</a>
			<button class="navbar-toggler" type="button"
				data-bs-toggle="collapse" data-bs-target="#navbarNav">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarNav">
				<ul class="navbar-nav">
					<li class="nav-item"><a class="nav-link active" href="#">æœ¬æ—¥æ–°è</a></li>

					<li class="nav-item"><a class="nav-link" href="#">CNN</a></li>
					<li class="nav-item"><a class="nav-link" href="#">BBC</a></li>
					<li class="nav-item"><a class="nav-link" href="#">NHK</a></li>
				</ul>
				<ul class="navbar-nav ms-auto">
					<li class="nav-item" th:if="${session.name}"><a
						class="nav-link disabled text-warning" href="#"> æ­¡è¿~<strong
							th:text="${name}">ä½¿ç”¨è€…</strong>
					</a></li>
					<li class="nav-item" th:if="${name}"><a class="nav-link"
						th:href="@{/logout}">ç™»å‡º</a></li>

					<!-- å¦‚æœæ²’ç™»å…¥ï¼Œé¡¯ç¤ºç™»å…¥è¨»å†Š -->
					<li class="nav-item" th:if="${username == null}"><a
						class="nav-link" th:href="@{/login}">ç™»å…¥</a></li>
					<li class="nav-item" th:if="${username == null}"><a
						class="nav-link" th:href="@{/register}">è¨»å†Š</a></li>
				</ul>
			</div>
		</div>
	</nav>

	<!-- ğŸ”µ æ–°èå¡ç‰‡å€ -->
	<div class="grid-container">
		<!-- ä¸‰å€‹å€å¡Šï¼šCNNã€BBC å’Œ NHK -->
		<div class="news-grid">


			<div class="news-section">
				<h2 class="news-section-title mb-3" translate="no">CNN</h2>

				<div th:each="news : ${newsList}"
					th:if="${news != null and news.title != null and news.title != ''}"
					class="news-card">
					<!-- ğŸŸ¢ æ”¶è—æŒ‰éˆ• -->
					<button type="button" class="star-button" onclick="toggleFavorite([[${news.id}]], [[${session.userId}]])">
  <span th:id="'star-' + ${news.id}"
        th:text="${news.favorited} ? 'ğŸ’–' : 'ğŸ¤'"
        th:class="${news.favorited} ? 'star filled' : 'star'"></span>
</button>
					<a th:href="${news.url}" target="_blank"
						style="text-decoration: none; color: inherit;">
						<div style="display: flex; align-items: center;">
							<img th:if="${news.urlToImage != null}"
								th:src="${news.urlToImage}" class="news-img" alt="æ–°èåœ–ç‰‡"
								onerror="this.style.display='none'" />
							<div class="news-content">
								<h5 class="news-title" th:text="${news.title}">æ¨™é¡Œ</h5>
								<div class="hover-description" th:text="${news.description}">æ‘˜è¦</div>
								<p class="text-muted news-time" th:text="${news.publishedAt}">ç™¼å¸ƒæ™‚é–“</p>

							</div>
						</div>
					</a>
				</div>


			</div>


			<!-- BBC News -->
			<div class="news-section">
				<h2 class="news-section-title mb-3" translate="no">BBC</h2>
				<div th:each="news : ${bbcNewsList}"
					th:if="${news.title != null} and ${news.title} != ''"
					class="news-card">
					<a th:href="${news.link}" target="_blank"
						style="text-decoration: none; color: inherit;">
						<div style="display: flex; align-items: center;">
							<img th:if="${news.imageUrl != null}" th:src="${news.imageUrl}"
								class="news-img" alt="æ–°èåœ–ç‰‡" onerror="this.style.display='none'" />
							<div class="news-content">
								<h5 class="news-title" th:text="${news.title}">æ¨™é¡Œ</h5>
								<div class="hover-description" th:text="${news.description}">å…§å®¹</div>
								<p class="text-muted news-time" th:text="${news.pubDate}">æ—¥æœŸ</p>
							</div>
						</div>
					</a>
				</div>
			</div>

			<!-- NHK News -->
			<div class="news-section">
				<h2 class="news-section-title mb-3" translate="no">NHK</h2>
				<div th:each="news : ${nhkNewsList}"
					th:if="${news.title != null} and ${news.title} != ''"
					class="news-card">
					<a th:href="${news.link}" target="_blank"
						style="text-decoration: none; color: inherit;">
						<div style="display: flex; align-items: center;">
							<img th:if="${news.imageUrl != null}" th:src="${news.imageUrl}"
								class="news-img" alt="æ–°èåœ–ç‰‡" onerror="this.style.display='none'" />
							<div class="news-content">
								<h5 class="news-title" th:text="${news.title}">æ¨™é¡Œ</h5>

								<div class="hover-description" th:text="${news.description}">å…§å®¹</div>
								<p class="text-muted news-time" th:text="${news.pubDate}">æ—¥æœŸ</p>
							</div>
						</div>
					</a>
				</div>
			</div>
			<script>
			function toggleFavorite(newsId, userId) {
			    if (!userId || userId === 'null') {
			        alert("è«‹å…ˆç™»å…¥æ‰èƒ½æ”¶è—ï¼");
			        return;
			    }

			    fetch(`/users/${userId}/favorites/${newsId}`, {
			        method: 'POST'
			    }).then(response => {
			        if (response.ok) {
			            const star = document.getElementById(`star-${newsId}`);
			            if (star.classList.contains('filled')) {
			                star.classList.remove('filled');
			                star.innerText = 'ğŸ¤';
			            } else {
			                star.classList.add('filled');
			                star.innerText = 'ğŸ’–';
			            }
			        } else {
			            alert("æ”¶è—å¤±æ•—ï¼");
			        }
			    }).catch(err => {
			        alert("ç³»çµ±éŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ï¼");
			        console.error(err);
			    });
			}
</script>
		</div>
	</div>

	</div>

</body>
</html>