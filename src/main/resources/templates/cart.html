
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>News Cart â€“ Newspaper Style</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        /* ===================== å…±ç”¨ ===================== */
        body {
            background: #f1f1f1;                     /* ä»¿å ±ç´™ç°åº• */
            font-family: "Times New Roman", serif;  /* å ±ç´™å¸¸è¦‹å­—é«” */
        }

        /* ===================== å ±ç´™é¢¨ç‰ˆé¢ ===================== */
        /* // ä¿®æ”¹ï¼šåŸ .news-card â†’ .news-article  */
        .news-article {               /* å–®æ¢æ–°è */
            display: flex;
            gap: 1rem;
            padding: 1.25rem 0;       /* æ¢èˆ‡æ¢é–“è· */
            border-bottom: 1px solid #ccc; /* ç´°åº•ç·šåˆ†éš” */
            transition: background 0.15s;
            background: #fff;         /* ç™½ç´™æ„Ÿ */
        }
        .news-article:hover {
            background: #f7f7f7;      /* ç•¥å¸¶ç°ï¼ŒåƒèˆŠå ±ç´™ç¿»é  */
        }

        .news-img {
            width: 140px;             /* // ä¿®æ”¹ï¼šå›ºå®šå°å°ºå¯¸ */
            height: 140px;
            object-fit: cover;        /* å¡«æ»¿ä¸è®Šå½¢ */
            flex-shrink: 0;
        }

        .news-body {
            flex: 1;
        }

        /* æ¨™é¡Œ â€“ ç²—é«”ã€å¤§å­—ã€ç·Šæ¹Šè¡Œé«˜ */
        .news-title {                 /* // ä¿®æ”¹ï¼šæ–°å¢ */
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: .5rem;
            line-height: 1.2;
        }

        /* å…§æ–‡æ‘˜è¦ â€“ å¸¸è¦å­—ç´š */
        .news-desc {                  /* // ä¿®æ”¹ï¼šæ–°å¢ */
            font-size: .95rem;
            line-height: 1.5;
            margin-bottom: .75rem;
        }

        /* æ™‚é–“ â€“ å°å­—ç°è‰² */
        .news-time {
            font-size: .8rem;
            color: #666;
        }

        /* æ“ä½œæŒ‰éˆ•å€ */
        .action-btns {
            display: flex;
            gap: .5rem;
        }
    </style>
</head>
<body onload="loadCart()">
<main class="container-lg py-4">
    <h1 class="display-5 text-center mb-4">ğŸ“° æ–°èå½™æ•´</h1>

    <!-- å‹•æ…‹å…§å®¹æœƒå¡é€²é€™è£¡ -->
    <div id="cart-content"></div>
</main>

<script>
function loadCart() {
  const ids = JSON.parse(localStorage.getItem("newsCart") || "[]")
              .filter(id => Number.isInteger(id) && id > 0);

  // ç©ºç‹€æ…‹
  if (ids.length === 0) {
    document.getElementById("cart-content").innerHTML = `
      <p class="text-center text-muted mt-5">ğŸ“­ ç›®å‰æ²’æœ‰æ”¶è—æ–°è</p>`;
    return;
  }

  fetch("/cart/load", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(ids)
  })
  .then(res => res.text())
  .then(html => {
    document.getElementById("cart-content").innerHTML = html;

    // ç¶å®šç§»é™¤äº‹ä»¶
    document.querySelectorAll(".remove-from-cart-btn").forEach(btn => {
      btn.addEventListener("click", function () {
        const id = parseInt(this.dataset.id);
        let cart = JSON.parse(localStorage.getItem("newsCart") || "[]");
        cart = cart.filter(item => item !== id);
        localStorage.setItem("newsCart", JSON.stringify(cart));
        loadCart();
      });
    });
  });
}
</script>

<!-- ===================== cartFragment ===================== -->
<div th:fragment="cartFragment">
  <div th:each="news : ${cartNews}" class="news-article">
    <img th:if="${news.imageUrl}" th:src="${news.imageUrl}" class="news-img" />

    <div class="news-body">
      <h2 class="news-title" th:text="${news.title}">æ¨™é¡Œ</h2>
      <p class="news-desc" th:text="${news.description}">å…§æ–‡æ‘˜è¦</p>
      <p class="news-time" th:text="${#temporals.format(news.publishedAt, 'yyyy-MM-dd HH:mm')}">æ—¥æœŸ</p>

      <div class="action-btns">
        <a th:href="${news.url}" target="_blank" class="btn btn-sm btn-outline-primary">é–±è®€å…¨æ–‡</a>
        <button class="btn btn-sm btn-danger remove-from-cart-btn" th:attr="data-id=${news.id}">ğŸ—‘ ç§»é™¤</button>
      </div>
    </div>
  </div>
</div>
</body>
</html>
